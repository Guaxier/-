import{r as b,d as G,D as O,G as j,c as R,b as e,w as s,x as r,f as i,g as E,a as B,N as V,X as q,a5 as M,i as k,a2 as T,E as F,_ as A,o as U,a6 as z,t as x,h as I,Q as K}from"./index.aa0178c7.js";import{b as P,c as Q,d as X,a as H,e as J}from"./groups.3153182e.js";function L(){const f={children:"children",label:"label"},o=b([]);return{defaultProps:f,myRule:o,handleCheckChange:(c,a)=>{const n=c.id;if(a)o.value.indexOf(n)<0&&o.value.push(n);else{const h=o.value.indexOf(n);h>=0&&o.value.splice(h,1)}}}}const W={class:""},Y={class:"dialog-footer"},Z=k("\u53D6\u6D88"),ee=k("\u786E\u5B9A"),te=G({__name:"add_group",props:{isShow:{type:Boolean,required:!0},rules:{type:Object,required:!0},edits:{type:Object,required:!0}},emits:["update:isShow","sub"],setup(f,{emit:o}){const m=f,c=b(!1),a=b(),n=O(m,"isShow",o),{defaultProps:h,myRule:v,handleCheckChange:C}=L(),_=b(),t=b(!0);j(()=>m.edits,u=>{a.value=u.name,u.id>0?(c.value=!0,t.value=!1,setTimeout(()=>{const p=u.list.split(",");_.value.setCheckedKeys(p,!1),t.value=!0},800)):c.value=!1});function l(){n.value=!1,_.value.setCheckedKeys([],!1),v.value=[]}function d(){const u=T(v.value);if(c.value){const p={title:a.value,rules:u,id:m.edits.id};Q(p).then(y=>{F.success("\u4FEE\u6539\u6210\u529F"),o("sub"),l()})}else{const p={title:a.value,rules:u};P(p).then(y=>{F.success("\u521B\u5EFA\u6210\u529F"),o("sub"),l()})}}return(u,p)=>{const y=i("el-input"),g=i("el-form-item"),S=i("el-form"),D=i("el-button"),$=i("el-dialog");return E(),R("div",W,[e($,{"model-value":r(n),title:c.value?"\u4FEE\u6539":"\u6DFB\u52A0\u7BA1\u7406\u7EC4",width:"35%",draggable:"",onClose:l},{footer:s(()=>[B("span",Y,[e(D,{onClick:l},{default:s(()=>[Z]),_:1}),e(D,{type:"primary",onClick:d},{default:s(()=>[ee]),_:1})])]),default:s(()=>[e(S,{"label-width":"80px"},{default:s(()=>[e(g,{label:"\u540D\u79F0"},{default:s(()=>[e(y,{modelValue:a.value,"onUpdate:modelValue":p[0]||(p[0]=w=>a.value=w),style:{width:"260px"}},null,8,["modelValue"])]),_:1}),V(e(g,{label:"\u6743\u9650"},{default:s(()=>[e(r(M),{ref_key:"treeRef",ref:_,"node-key":"id",data:f.rules,props:r(h),"show-checkbox":"","render-after-expand":!1,onCheckChange:r(C)},null,8,["data","props","onCheckChange"])]),_:1},512),[[q,t.value]])]),_:1})]),_:1},8,["model-value","title"])])}}});const le=A(te,[["__scopeId","data-v-1f22ac18"]]);function oe(){const f=b(),o=b(!1),m=b(),c=b(),a={};function n(){H().then(t=>{f.value=t})}X().then(t=>{const l=h(t);m.value=Object.values(l)});function h(t,l=0){if(l>=t.length)return;const d=t[l];if(d.pid===0)a[d.id]={id:d.id,label:d.title,children:[]};else if(d.pid.toString()in a){const u={id:d.id,label:d.title};a[d.pid].children.push(u)}return h(t,l+1),a}function v(){c.value={id:0,name:"",list:""},o.value=!0}function C(t){const l=f.value[t];c.value={id:l.id,name:l.title,list:l.rules},o.value=!0}return{loadData:n,edit:C,del:t=>{J(t).then(l=>{F.success("\u5220\u9664\u6210\u529F"),n()})},open:v,isShow:o,rules:m,tableData:f,editData:c}}const se={class:"page-sys-groups right-main"},ae={class:"flex"},ne={class:"option-btn"},ue=G({__name:"groups",setup(f){U(()=>{o()});const{loadData:o,edit:m,del:c,open:a,isShow:n,rules:h,tableData:v,editData:C}=oe();return(_,t)=>{const l=i("plus"),d=i("el-icon"),u=i("el-button"),p=i("el-col"),y=i("el-row"),g=i("el-table-column"),S=i("el-popconfirm"),D=i("el-table"),$=K("auth");return E(),R("div",se,[e(y,{class:"mb-3 top-search-box"},{default:s(()=>[e(p,{span:14},{default:s(()=>[B("div",ae,[e(u,{type:"primary",onClick:r(a)},{default:s(()=>[e(d,{class:"add-btn",color:"#fff"},{default:s(()=>[e(l)]),_:1}),k(x(_.$t("msg.table.add")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1}),e(D,{data:r(v),style:{width:"100%"},class:"table-list"},{default:s(()=>[e(g,{align:"center",type:"index",label:_.$t("msg.table.sortNumber"),width:"70"},null,8,["label"]),e(g,{align:"left",prop:"title",label:_.$t("msg.table.name")},null,8,["label"]),e(g,{align:"center",label:_.$t("msg.table.operation"),width:"180"},{default:s(w=>[B("div",ne,[e(u,{size:"small",plain:"",onClick:N=>r(m)(w.$index)},{default:s(()=>[k(x(_.$t("msg.table.edit")),1)]),_:2},1032,["onClick"]),e(S,{title:"\u662F\u5426\u5220\u9664",onConfirm:N=>r(c)(w.row.id)},{reference:s(()=>[V((E(),I(u,{size:"small",type:"danger",plain:""},{default:s(()=>[k(x(_.$t("msg.table.remove")),1)]),_:1})),[[$,["ArticleDel"]]])]),_:2},1032,["onConfirm"])])]),_:1},8,["label"])]),_:1},8,["data"]),e(le,{isShow:r(n),"onUpdate:isShow":t[0]||(t[0]=w=>z(n)?n.value=w:null),rules:r(h),onSub:r(o),edits:r(C)},null,8,["isShow","rules","onSub","edits"])])}}});const de=A(ue,[["__scopeId","data-v-bb3b587c"]]);export{de as default};
