import{U as D,d as x,r as h,C as j,G,D as L,c as S,b as t,w as l,x as N,f as s,g as f,a as U,h as E,L as k,F as M,v as q,i as b,E as F,_ as I,o as z,t as w,N as P,Q}from"./index.aa0178c7.js";import{a as H}from"./groups.3153182e.js";import{d as J}from"./common.dc574b31.js";const K=()=>D({url:"admins_list"}),R=i=>D({url:"admins_del?id="+i,method:"DELETE"}),W=i=>D({url:"admins_add",method:"POST",data:i}),X=i=>D({url:"admins_update_gid",method:"POST",data:i}),Y={class:""},Z={class:"dialog-footer"},ee=b("\u53D6\u6D88"),te=b("\u786E\u5B9A"),le=x({__name:"add_admins",props:{isShow:{type:Boolean,required:!0},data:{type:Object,required:!0},groups:{type:Object}},emits:["update:isShow","sub"],setup(i,{emit:p}){const _=i,n=h(!1),a=j({username:"",gid:0,password:"",password2:""});G(()=>_.data,u=>{a.username=u.name,a.gid=u.groupId*1,a.password="",a.password2="",u.name===""?n.value=!1:n.value=!0});const y=L(_,"isShow",p);function g(){y.value=!1,p("sub")}const $=()=>{if(!n.value)W(a).then(u=>{F.success("\u521B\u5EFA\u6210\u529F"),g()});else{let u={id:_.data.id,gid:a.gid};X(u).then(e=>{F.success("\u4FEE\u6539\u6210\u529F"),g()})}};return(u,e)=>{const o=s("el-input"),r=s("el-form-item"),A=s("el-option"),v=s("el-select"),B=s("el-form"),V=s("el-button"),c=s("el-dialog");return f(),S("div",Y,[t(c,{"model-value":N(y),title:n.value?"\u6DFB\u52A0\u7BA1\u7406\u5458":"\u4FEE\u6539",width:"35%",draggable:"",onClose:g},{footer:l(()=>[U("span",Z,[t(V,{onClick:g},{default:l(()=>[ee]),_:1}),t(V,{type:"primary",onClick:$},{default:l(()=>[te]),_:1})])]),default:l(()=>[t(B,{model:a,"label-width":"80px"},{default:l(()=>[t(r,{label:"\u7528\u6237\u540D"},{default:l(()=>[t(o,{disabled:n.value,style:{width:"260px"},modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=d=>a.username=d)},null,8,["disabled","modelValue"])]),_:1}),n.value?k("",!0):(f(),E(r,{key:0,label:"\u5BC6\u7801"},{default:l(()=>[t(o,{type:"password",style:{width:"260px"},modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=d=>a.password=d)},null,8,["modelValue"])]),_:1})),n.value?k("",!0):(f(),E(r,{key:1,label:"\u786E\u8BA4\u5BC6\u7801"},{default:l(()=>[t(o,{type:"password",style:{width:"260px"},modelValue:a.password2,"onUpdate:modelValue":e[2]||(e[2]=d=>a.password2=d)},null,8,["modelValue"])]),_:1})),t(r,{label:"\u7BA1\u7406\u7EC4"},{default:l(()=>[t(v,{modelValue:a.gid,"onUpdate:modelValue":e[3]||(e[3]=d=>a.gid=d),placeholder:"Select"},{default:l(()=>[(f(!0),S(M,null,q(i.groups,(d,C)=>(f(),E(A,{key:C,label:d,value:Number(C)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["model-value","title"])])}}});const ae=I(le,[["__scopeId","data-v-91a7518a"]]),oe={class:"page-sys-admins right-main"},se={class:"flex"},ne=x({__name:"admins",setup(i){const p=h(!1),_=h({id:0,name:"",groupId:0}),n=h();z(()=>{a()});function a(){K().then(e=>{n.value=e})}const y=e=>{R(e).then(o=>{F.success("\u5220\u9664\u6210\u529F"),a()})};function g(){_.value={id:0,name:"",groupId:0},p.value=!0}function $(e){const o=n.value[e];_.value={name:o.username,id:o.id,groupId:o.group_id},p.value=!0}const u=h();return H().then(e=>{let o={};e.forEach(r=>{o[r.id]=r.title}),console.log(o),u.value=o}),(e,o)=>{const r=s("plus"),A=s("el-icon"),v=s("el-button"),B=s("el-col"),V=s("el-row"),c=s("el-table-column"),d=s("el-popconfirm"),C=s("el-table"),O=Q("auth");return f(),S("div",oe,[t(V,{class:"mb-3 top-search-box"},{default:l(()=>[t(B,{span:14},{default:l(()=>[U("div",se,[t(v,{type:"primary",onClick:g},{default:l(()=>[t(A,{class:"add-btn",color:"#fff"},{default:l(()=>[t(r)]),_:1}),b(w(e.$t("msg.table.add")),1)]),_:1})])]),_:1})]),_:1}),t(C,{data:n.value,style:{width:"100%"},class:"table-list"},{default:l(()=>[t(c,{align:"center",type:"index",label:e.$t("msg.table.sortNumber"),width:"70"},null,8,["label"]),t(c,{align:"center",prop:"username",label:e.$t("msg.table.name"),width:"180"},null,8,["label"]),t(c,{align:"center",prop:"address",label:e.$t("msg.table.group")},{default:l(m=>[b(w(u.value[m.row.group_id]),1)]),_:1},8,["label"]),t(c,{align:"center",label:e.$t("msg.table.date"),width:"180"},{default:l(m=>[b(w(N(J)(m.row.login_time)),1)]),_:1},8,["label"]),t(c,{align:"center",label:e.$t("msg.table.operation")},{default:l(m=>[t(v,{size:"small",onClick:T=>$(m.$index)},{default:l(()=>[b(w(e.$t("msg.table.edit")),1)]),_:2},1032,["onClick"]),t(d,{title:"\u662F\u5426\u5220\u9664",onConfirm:T=>y(m.row.id)},{reference:l(()=>[P((f(),E(v,{size:"small",type:"danger",plain:""},{default:l(()=>[b(w(e.$t("msg.table.remove")),1)]),_:1})),[[O,["ArticleDel"]]])]),_:2},1032,["onConfirm"])]),_:1},8,["label"])]),_:1},8,["data"]),t(ae,{onSub:a,groups:u.value,isShow:p.value,"onUpdate:isShow":o[0]||(o[0]=m=>p.value=m),data:_.value},null,8,["groups","isShow","data"])])}}});const re=I(ne,[["__scopeId","data-v-3a03d6f2"]]);export{re as default};
